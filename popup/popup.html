<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>iCloud Album Downloader</title>
  <link rel="stylesheet" href="popup.css" />
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="logo">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"/>
        </svg>
        <h1>iCloud Album Downloader</h1>
      </div>
    </header>

    <!-- URL Input -->
    <section class="input-section">
      <label for="album-url">Shared Album URL</label>
      <div class="input-row">
        <input
          type="url"
          id="album-url"
          placeholder="https://www.icloud.com/sharedalbum/#B0aG..."
          spellcheck="false"
          autocomplete="off"
        />
        <button id="btn-scan" class="btn btn-primary">Scan</button>
      </div>
      <p class="hint" id="auto-detect-hint" style="display:none">
        Auto-detected from current tab
      </p>
    </section>

    <!-- Error -->
    <section id="error-section" class="error-section" style="display:none">
      <div class="error-box">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/>
        </svg>
        <span id="error-text"></span>
      </div>
    </section>

    <!-- Loading -->
    <section id="loading-section" class="loading-section" style="display:none">
      <div class="spinner"></div>
      <p>Scanning album...</p>
    </section>

    <!-- Album Info -->
    <section id="album-info" class="album-info" style="display:none">
      <h2>Album Contents</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <span class="stat-value" id="stat-total">0</span>
          <span class="stat-label">Total Items</span>
        </div>
        <div class="stat-card stat-photo">
          <span class="stat-value" id="stat-photos">0</span>
          <span class="stat-label">Photos</span>
        </div>
        <div class="stat-card stat-video">
          <span class="stat-value" id="stat-videos">0</span>
          <span class="stat-label">Videos</span>
        </div>
        <div class="stat-card">
          <span class="stat-value" id="stat-size">0 MB</span>
          <span class="stat-label">Total Size</span>
        </div>
      </div>

      <!-- Download Options -->
      <div class="download-options">
        <label for="folder-name">Save to folder</label>
        <input
          type="text"
          id="folder-name"
          placeholder="iCloud Album"
          spellcheck="false"
        />
        <div class="btn-group">
          <button id="btn-download-all" class="btn btn-primary btn-block">
            Download All
          </button>
          <div class="btn-row">
            <button id="btn-download-photos" class="btn btn-secondary" style="display:none">
              Photos Only
            </button>
            <button id="btn-download-videos" class="btn btn-secondary" style="display:none">
              Videos Only
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Progress -->
    <section id="progress-section" class="progress-section" style="display:none">
      <h2>Downloading...</h2>
      <div class="progress-bar-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
      <p class="progress-text">
        <span id="progress-count">0</span> / <span id="progress-total">0</span>
        <span id="progress-failed" style="display:none"> â€” <span class="text-red" id="failed-count">0</span> failed</span>
      </p>
      <button id="btn-cancel" class="btn btn-danger btn-block">Cancel</button>
    </section>

    <!-- Complete -->
    <section id="complete-section" class="complete-section" style="display:none">
      <div class="complete-icon">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
          <polyline points="22 4 12 14.01 9 11.01"/>
        </svg>
      </div>
      <h2>Download Complete</h2>
      <p id="complete-summary"></p>
      <div id="complete-errors" style="display:none">
        <p class="text-red" id="complete-errors-text"></p>
      </div>
      <button id="btn-reset" class="btn btn-secondary btn-block">Scan Another Album</button>
    </section>
  </div>

  <script src="popup.js"></script>
</body>
</html>
